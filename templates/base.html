<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>

<nav class="sidebar">
    <div class="logo">IB Competition</div>
    <div class="nav-links">
        <a href="{{ url_for('dashboard') }}" class="nav-link {% if request.endpoint=='dashboard' %}active{% endif %}">Главная</a>
        <a href="{{ url_for('team')      }}" class="nav-link {% if request.endpoint=='team'      %}active{% endif %}">Команда</a>
        <a href="{{ url_for('events')    }}" class="nav-link {% if request.endpoint=='events'    %}active{% endif %}">События</a>
        <a href="{{ url_for('profile')   }}" class="nav-link {% if request.endpoint=='profile'   %}active{% endif %}">Профиль</a>

        {% if session.get('role') == 'admin' %}
        <div class="admin-links">
            <a href="{{ url_for('admin_users') }}" class="nav-link {% if request.endpoint=='admin_users' %}active{% endif %}">Пользователи</a>
            <a href="{{ url_for('admin_teams') }}" class="nav-link {% if request.endpoint=='admin_teams' %}active{% endif %}">Команды</a>
        </div>
        {% endif %}
    </div>
</nav>

<header class="topbar">
    <div class="top-title">{{ page_title }}</div>
    <div class="avatar-menu">
        <span class="user-name">{{ g.user }}</span>
        <img src="{{ url_for('static', filename='default-avatar.png') }}" class="avatar" id="avatarBtn">
        <div class="dropdown" id="dropdownMenu">
            <a href="{{ url_for('profile') }}">Профиль</a>
            <a href="{{ url_for('logout') }}">Выйти</a>
        </div>
    </div>
</header>

<main>
    {% block content %}{% endblock %}
</main>

<!-- inline‑script (тот же, что был)  -->
<script>
document.addEventListener('DOMContentLoaded',()=>{

  const avatarBtn=document.getElementById('avatarBtn');
  const avatarMenu=document.getElementById('dropdownMenu');
  if(avatarBtn){
      avatarBtn.addEventListener('click',e=>{
          e.stopPropagation();avatarMenu.classList.toggle('show');
      });
      document.addEventListener('click',()=>avatarMenu.classList.remove('show'));
  }

  document.querySelectorAll('.action-btn').forEach(btn=>{
      const menu=btn.nextElementSibling;
      btn.addEventListener('click',e=>{
          e.preventDefault();e.stopPropagation();
          menu.classList.toggle('show-menu');
      });
  });
  document.addEventListener('click',()=>{
      document.querySelectorAll('.action-menu.show-menu')
              .forEach(m=>m.classList.remove('show-menu'));
  });

  /* модалка удаления аккаунта */
  const delBtn=document.getElementById('delAccountBtn');
  if(delBtn){
      const modal=document.getElementById('delModal');
      delBtn.addEventListener('click',()=>modal.classList.add('open'));
      modal.querySelector('.close').addEventListener('click',()=>modal.classList.remove('open'));
  }

});
</script>
</body>
</html>
