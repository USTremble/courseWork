{% extends 'base.html' %}
{% block title %}Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ{% endblock %}

{% block content %}
<h1>Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ</h1>

{% if not team %}
  <p>ĞÑƒĞ¶Ğ½Ğ¾ ÑĞ¾ÑÑ‚Ğ¾ÑÑ‚ÑŒ Ğ² ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğµ.</p>
{% else %}

  {# â”€â”€â”€â”€â”€â”€â”€â”€â”€ Ñ„Ğ¾Ñ€Ğ¼Ğ° Â«ĞŸÑ€Ğ¸ÑĞ¾ĞµĞ´Ğ¸Ğ½Ğ¸Ñ‚ÑŒÑÑ Ğ¿Ğ¾ ĞºĞ¾Ğ´ÑƒÂ» â”€â”€â”€â”€â”€â”€â”€â”€â”€ #}
  {% if show_join %}
  <div class="content-box" style="max-width:320px">
    <h3>ĞŸÑ€Ğ¸ÑĞ¾ĞµĞ´Ğ¸Ğ½Ğ¸Ñ‚ÑŒÑÑ Ğ¿Ğ¾ ĞºĞ¾Ğ´Ñƒ</h3>
    <form method="post">
      <input name="code" placeholder="ĞšĞ¾Ğ´ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ" required>
      <button class="btn" style="margin-top:8px">ĞŸÑ€Ğ¸ÑĞ¾ĞµĞ´Ğ¸Ğ½Ğ¸Ñ‚ÑŒÑÑ</button>
    </form>
    {% for c,m in get_flashed_messages(with_categories=True) if c=='error' %}
      <p style="color:#e05555">{{ m }}</p>
    {% endfor %}
  </div>
  {% endif %}

  {# â”€â”€â”€â”€â”€â”€â”€â”€â”€ waiting-ĞºĞ°Ñ€Ñ‚Ğ¾Ñ‡ĞºĞ¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€ #}
  {% if show_join and waiting %}
    <h2 style="margin-top:28px">Ğ”Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ğµ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ</h2>
    <div class="card-grid">
      {% for e in waiting %}
        <div class="card">
          <h4>{{ e[1] }}</h4>
          <p>Ğ¢Ğ¸Ğ¿: {{ e[2]|upper }}</p>
          <p>{{ e[3] }}</p>
          <p>ĞšĞ¾Ğ¼Ğ°Ğ½Ğ´ Ğ² Ğ¾Ñ‡ĞµÑ€ĞµĞ´Ğ¸: {{ e[4] }}</p>
          <form method="post">
            <input type="hidden" name="join_eid" value="{{ e[0] }}">
            <button class="btn">Ğ£Ñ‡Ğ°ÑÑ‚Ğ²Ğ¾Ğ²Ğ°Ñ‚ÑŒ</button>
          </form>
        </div>
      {% endfor %}
    </div>
  {% endif %}

  {# â”€â”€â”€â”€â”€â”€â”€â”€â”€ Ñ‚ĞµĞºÑƒÑ‰ĞµĞµ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ â”€â”€â”€â”€â”€â”€â”€â”€â”€ #}
  {% if current %}
    <div class="content-box" style="margin-top:32px">
      <h2>{{ current[1] }} â€” {{ current[2] }}</h2>

      {% if current[2]=='waiting' %}
        <p>ĞĞ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ´Ñ€ÑƒĞ³Ğ¸Ñ… ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´â€¦</p>

      {% elif current[2]=='running' %}
        <p><a href="{{ url_for('static', filename=current[6]) }}" target="_blank">
           ğŸ“„ Ğ¡ĞºĞ°Ñ‡Ğ°Ñ‚ÑŒ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ</a></p>

        <form method="post" action="{{ url_for('submit_answer', eid=current[0]) }}">
          <label>ĞÑ‚Ğ²ĞµÑ‚</label>
          <input name="answer" required>
          <button class="btn">ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ</button>
        </form>

      {% if lb %}
        <h3 style="margin-top:24px">Leaderboard</h3>
        {% include '_lb.html' %}
      {% endif %}

      {% elif current[2]=='finished' %}
        <h3>Ğ˜Ñ‚Ğ¾Ğ³Ğ¸</h3>
        {% if lb %}{% include '_lb.html' %}{% endif %}
      {% endif %}
    </div>
  {% endif %}

  {% if not current and not waiting %}
    <p style="margin-top:24px">ĞĞµÑ‚ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ñ… ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹.</p>
  {% endif %}
{% endif %}

<style>
.card-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:16px;margin-top:12px}
.card{border:1px solid #c7d9e1;border-radius:8px;padding:14px;box-shadow:0 2px 6px rgba(0,0,0,.06)}
.card h4{margin:0 0 6px 0}
.admin-table{border-collapse:collapse;width:100%;margin-top:8px}
.admin-table th,.admin-table td{padding:6px 8px;border:1px solid #d4dee4;text-align:center}
.admin-table thead{background:#f0f6fa;font-weight:600}
</style>
{% endblock %}
