{% extends 'base.html' %}
{% block title %}Админ — Пользователи{% endblock %}

{% block content %}
<h1>Пользователи</h1>

<table class="admin-table">
  <thead>
    <tr>
      <th>UID</th><th>Ник</th><th>Команды</th><th>Роль</th><th></th><th>Действие</th>
    </tr>
  </thead>
  <tbody>
  {% for u in users %}
    <tr>
      <td>{{ u[0] }}</td>
      <td style="display:flex;align-items:center;gap:6px">
        <span>{{ u[1] }}</span>
        {% if u[3] %}   {# is_blocked #}
          <span style="width:10px;height:10px;border-radius:50%;background:#e05555"
                title="Заблокирован"></span>
        {% else %}
          <span style="width:10px;height:10px;border-radius:50%;background:#3cb371"
                title="Активен"></span>
        {% endif %}
      </td>
      <td>{{ u[4] }}</td>
      <td>{{ u[2] }}</td>
      <td>
        <form method="post" action="{{ url_for('admin_user_action') }}">
          <input type="hidden" name="uid" value="{{ u[0] }}">
          <select name="act" onchange="this.form.submit()">
            <option disabled selected>Действие</option>
            <option value="moder">Назначить модератором</option>
            <option value="toggle">{{ 'Разблокировать' if u[3] else 'Заблокировать' }}</option>
            <option value="delete">Удалить</option>
          </select>
        </form>
      </td>
    </tr>
  {% endfor %}
  </tbody>
</table>
{% endblock %}
