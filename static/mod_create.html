<!DOCTYPE html><html lang="ru"><head>
  <meta charset="UTF-8"><title>Создать событие</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="stylesheet" href="/static/css/style.css"></head><body>
  
  <nav class="sidebar"><div class="logo">IB Competition</div><div id="navLinks"></div></nav>
  <header class="topbar">
    <div class="top-title">Создать событие</div>
    <div class="avatar-menu"><span id="uname"></span>
      <img src="/static/default-avatar.png" class="avatar" id="aBtn">
      <div class="dropdown" id="dd"><a href="/profile.html">Профиль</a><a href="#" id="lo">Выйти</a></div></div>
  </header>
  
  <main style="padding-bottom:60px">
    <h1>Создать событие</h1>
    <div id="msg" class="content-box" style="display:none;margin-bottom:18px"></div>
  
    <form id="cForm" class="content-box" style="max-width:460px">
      <label>Код (≤16)</label><input name="code" maxlength="16">
      <label>Название</label><input name="name" required>
      <label>Описание</label><textarea name="desc"></textarea>
      <label>Тип</label>
      <select name="ev_type">
        <option value="quiz">Квиз</option><option value="ctf">CTF</option>
      </select>
      <label>Ответ</label><input name="answer" required>
      <label>PDF-задание</label><input type="file" name="task" accept=".pdf" required>
      <button class="btn" style="margin-top:12px">Создать</button>
    </form>
  </main>
  
  <script type="module">
  import { initCommon } from '/static/js/common.js';
  await initCommon('Создать событие');
  
  const $=q=>document.querySelector(q);
  $('#cForm').onsubmit=async e=>{
    e.preventDefault();
    const fd=new FormData(e.target);
    const r=await fetch('/api/mod/events',{method:'POST',credentials:'include',body:fd});
    const box=$('#msg'); box.style.display='block';
    if(r.ok){
      const j=await r.json();
      box.innerHTML=`Событие создано. <a href="/mod_manage.html?code=${j.data.code}">Перейти к проведению</a>`;
    }else{
      box.textContent=(await r.json()).msg||'Ошибка';
    }
  };
  </script>
  
  <style>
  .content-box{border:1px solid #c7d9e1;border-radius:8px;padding:18px;box-shadow:0 2px 6px rgba(0,0,0,.06)}
  .btn{background:#0084c6;color:#fff;padding:6px 12px;border:none;border-radius:4px;cursor:pointer}
  </style>
  </body></html>
  